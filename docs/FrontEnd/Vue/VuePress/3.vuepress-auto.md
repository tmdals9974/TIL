# 사이드메뉴 자동화

## 자동화 소스

1. .vuepress/util.js

```javascript
const dirTree = require('directory-tree'); //directory를 tree구조로 얻을 수 있게 해주는 라이브러리
const path = require('path');

const docs = path.join(__dirname, '../'); //docs 폴더 경로
const ext = '.md'; //찾고자 하는 파일 확장자
const excludesFolderName = ['.vuepress', 'about']; //제외할 폴더 이름
const tree = dirTree(docs).children.filter(
	v => !excludesFolderName.includes(v.name) && v.type === 'directory'
); //tree는 docs 하위 폴더를 가지고 있음 (excludesFolderName 제외)

//tree를 받아 sidebar 형태로 리턴해주는 함수
const treeToSidebar = function(tree) {
	const sidebar = [];

	tree.forEach(item => {
		sidebar.push(new sidebarRootItem(item.name, getChildren(item)));
	}); //하위폴더들을 하나씩 sidebar로 생성

	return sidebar;
};

//폴더를 받아 폴더 내 .md 파일들을 sidebar 형태로 리턴해줌
//만약 하위 폴더가 있다면 함수를 한번 더 호출함.
const getChildren = function(directory) {
	const dir = directory.children; //폴더 내 하위 폴더&파일들
	const children = [];

	dir.forEach(item => {
		if (item.type === 'directory') {
			//폴더일 경우
			const items = getChildren(item); //함수 호출
			children.push(new sidebarItem(item.name, items)); //sidebar에 추가
		} else if (item.type === 'file' && item.extension === ext) {
			//파일이며 .md일 경우
			children.push(
				//sidebar에 추가
				item.path
					.toString()
					.replace(docs, '')
					.replace(ext, '')
					.replace(/\\/gi, '/')
			);
		}
	});

	return children;
};

const sidebarItem = function(title, children = []) {
	return {
		title,
		children
	};
};

const sidebarRootItem = function(title, children) {
	const item = sidebarItem(title, children);
	item.initialOpenGroupIndex = -1;
	return item;
};

const sidebar = treeToSidebar(tree);

module.exports = sidebar;
```

2. .vuepress/config.js

```javascript
const sidebar = require('./util');

module.exports = {
	title: 'TIL_SM',
	description: 'Today SeungMin Learned',
	base: '/TIL/',
	head: [['link', { rel: 'icon', href: '/logo.ico' }]],
	themeConfig: {
		logo: '/logo.png', // 로고 이미지
		nav: [
			{ text: 'GitHub', link: 'https://github.com/tmdals9974/' },
			{ text: 'About', link: '/about/' }
		],
		smoothScroll: true,
		lastUpdated: true,
		sidebar
	}
};
```
